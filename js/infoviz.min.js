(function(){if(b){return}var b={};var f,i,a,c;b.options={layout:{"padding-top":1,"padding-right":1,"padding-bottom":1,"padding-left":1,"background-color":"#FFF","background-alpha":1,"logo-enabled":false,"logo-width":50,"logo-height":23,"logo-position":"top-right",speed:300,"box-border-width":1,"box-border-color":"#AAA","box-border-alpha":1,"box-background-color":"#F9F9F9","box-background-alpha":0.9},grid:{"padding-top":10,"padding-right":10,"padding-bottom":10,"padding-left":10,"grid-width":1,"grid-color":"#CCC","grid-alpha":0.5,"axis-width":1,"axis-color":"#999","axis-alpha":1,"axis-dot-size":2.4,"border-width":1,"border-color":"#AAA","border-alpha":1,"border-radius":4,"background-color":"#FFF","background-alpha":1,"vertical-label-margin":5,"vertical-label-spacing":40,"vertical-label-size":12,"vertical-label-color":"#555","vertical-name-size":12,"vertical-name-color":"#000","horizontal-label-margin":5,"horizontal-label-spacing":10,"horizontal-label-size":12,"horizontal-label-color":"#555","horizontal-name-size":12,"horizontal-name-color":"#000"},legend:{width:undefined,height:undefined,"legend-enabled":true,"legend-position":"top-left","margin-top":10,"margin-right":10,"margin-bottom":10,"margin-left":10,"padding-top":5,"padding-right":8,"padding-bottom":5,"padding-left":8,"indicator-size":14,"indicator-border-width":1,"indicator-margin-left":0,"indicator-margin-right":10,"indicator-margin-top":2,"indicator-margin-bottom":2,"indicator-sector-angle":60,"label-color":undefined,"label-alpha":1,"label-size":12,"border-width":1,"border-color":"#CCC","border-alpha":1,"border-radius":4,"background-color":"#FDFDFD","background-alpha":1},tooltip:{"padding-top":6,"padding-right":8,"padding-bottom":6,"padding-left":8,"border-width":1,"border-color":"#CCC","border-alpha":1,"border-radius":4,"title-text-color":undefined,"title-text-alpha":1,"title-text-weight":"bold","title-text-size":12,"line-spacing":2,"content-text-color":"#999","content-text-alpha":1,"content-text-weight":"normal","content-text-size":12,"background-color":"#FDFDFD","background-alpha":1,"horizontal-offset":0,"vertical-offset":-10},linechart:{"padding-top":30,"padding-right":90,"padding-bottom":20,"padding-left":30,"line-width":2,"circle-radius":5,"label-size":12,"vertical-label-count":10,"vertical-bar-width":5,"custom-circle":undefined},bubblechart:{"padding-top":40,"padding-right":100,"padding-bottom":40,"padding-left":60,"circle-border-width":2,"circle-min-radius":15,"circle-max-radius":40,"label-size":12,"horizontal-label-count":10,"horizontal-bar-width":5,"vertical-label-count":5,"vertical-bar-width":5},barchart:{"padding-top":30,"padding-right":30,"padding-bottom":20,"padding-left":30,"group-margin":40,"bar-margin":4,"vertical-label-count":10,"vertical-bar-width":5},piechart:{"size-factor":0.9,"sector-border-width":1,"label-distance":5,"label-line-width":1,"label-line-color":"#555","label-line-alpha":1,"label-size":11,"label-bar-length1":5,"label-bar-length2":10,"hole-radius":0,"horizontal-offset":0,"vertical-offset":0},radarchart:{"size-factor":0.9,"outer-border-width":1,"outer-border-color":"#999","outer-border-alpha":1,"outer-background-color":"#FFF","outer-background-alpha":1,"inner-border-width":1,"inner-border-color":"#CCC","inner-border-alpha":1,"inner-background-color":"#F9F9F9","inner-background-alpha":1,"axis-width":2,"axis-color":"#999","axis-alpha":1,"circle-border-width":2,"circle-background-alpha":0.1,"circle-min-radius":30,"label-distance":15,"label-color":"#555","label-size":12,"label-rotation":false,"horizontal-offset":0,"vertical-offset":0},smithgraph:{"size-factor":0.9,"horizontal-offset":0,"vertical-offset":0},heatmap:{horizontal_margin:4,vertical_margin:4,"box-border-width":1,"label-size":12,"label-color":"#FFF","label-alpha":1,horizontal_count:undefined,vertical_count:undefined,color:[{color:"#339999","dark-alpha":1,"light-alpha":0.45},{color:"#99CC99","dark-alpha":1,"light-alpha":0.45},{color:"#99CC33","dark-alpha":1,"light-alpha":0.45},{color:"#CCCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FFCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FF6633","dark-alpha":1,"light-alpha":0.45},{color:"#FF3333","dark-alpha":1,"light-alpha":0.45},{color:"#CC0066","dark-alpha":1,"light-alpha":0.45}]},tagcloud:{levels:10,"text-min-size":10,"text-max-size":55,"row-count":5,horizontal_margin:5,vertical_margin:-10,color:[{color:"#339999","dark-alpha":1,"light-alpha":0.45},{color:"#99CC99","dark-alpha":1,"light-alpha":0.45},{color:"#99CC33","dark-alpha":1,"light-alpha":0.45},{color:"#CCCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FFCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FF6633","dark-alpha":1,"light-alpha":0.45},{color:"#FF3333","dark-alpha":1,"light-alpha":0.45},{color:"#CC0066","dark-alpha":1,"light-alpha":0.45}]},color:[{color:"#66B3DD","dark-alpha":1,"light-alpha":0.45},{color:"#EF7D31","dark-alpha":1,"light-alpha":0.45},{color:"#ABC93C","dark-alpha":1,"light-alpha":0.45},{color:"#E05170","dark-alpha":1,"light-alpha":0.45},{color:"#297FB5","dark-alpha":1,"light-alpha":0.45},{color:"#F5BE21","dark-alpha":1,"light-alpha":0.45},{color:"#5ABABB","dark-alpha":1,"light-alpha":0.45},{color:"#9D66A4","dark-alpha":1,"light-alpha":0.45}]};b.chart=function(o,p,n,k,s){var t=$(o).attr("id")?$(o).attr("id"):"infoviz_"+g();$(o).attr("id",t);var l=Raphael(t,$(o).width(),$(o).height());var u=e(k);var j={"top-left":[u.layout["padding-left"],u.layout["padding-top"]],"top-right":[l.width-u.layout["padding-right"],u.layout["padding-top"]],"bottom-left":[u.layout["padding-left"],l.height-u.layout["padding-bottom"]],"bottom-right":[l.width-u.layout["padding-right"],l.height-u.layout["padding-bottom"]],width:l.width,height:l.height};l.rect(0,0,l.width,l.height).attr({stroke:"none",fill:u.layout["background-color"],"fill-opacity":u.layout["background-alpha"]});switch(p){case"linechart":j=b.draw_axis_background(l,n,u);b.draw_linechart(l,j,n,u,s);break;case"bubblechart":j=b.draw_axis_background(l,n,u);b.draw_bubblechart(l,j,n,u,s);break;case"barchart":j=b.draw_axis_background(l,n,u);b.draw_barchart(l,j,n,u,s);break;case"piechart":j=b.draw_empty_background(l,n,u);b.draw_piechart(l,j,n,u,s);break;case"radarchart":j=b.draw_empty_background(l,n,u);b.draw_radarchart(l,j,n,u,s);break;case"heatmap":j=b.draw_empty_background(l,n,u);b.draw_heatmap(l,j,n,u,s);break;case"tagcloud":j=b.draw_empty_background(l,n,u);b.draw_tagcloud(l,j,n,u,s);break;case"smithgraph":j=b.draw_empty_background(l,n,u);b.draw_smithgraph(l,j,n,u,s);break;default:l.text(j.width/2,j.height/2,'Type "'+p+'" not supported.').attr({"font-size":12,fill:"#000"}).translate(0.5,0.5);break}if(u.layout["logo-enabled"]){var r,q;switch(u.layout["logo-position"]){default:case"top-right":r=j["top-right"][0]-u.layout["logo-width"];q=j["top-right"][1];break;case"top-left":r=j["top-left"][0];q=j["top-right"][1];break;case"bottom-left":r=j["bottom-left"][0];q=j["bottom-left"][1]-u.layout["logo-height"];break;case"bottom-right":r=j["bottom-right"][0]-u.layout["logo-width"];q=j["bottom-right"][1]-u.layout["logo-height"];break}var m=l.image("./images/infoviz_logo_tiny.png",r,q,u.layout["logo-width"],u.layout["logo-height"]).attr({cursor:"pointer"}).translate(0.5,0.5);m.click(function(){window.location.href="https://github.com/nocoo/InfoViz"})}};b.draw_empty_background=function(l,o,k){if(!l){return h("Paper is empty.")}var u=e(k),p={},t=l.width,n=l.height,j=[],s,r;var m=l.rect(0,0,t,n);m.attr({stroke:"none",fill:u.layout["background-color"],"fill-opacity":u.layout["background-alpha"]});var q=l.rect(u.layout["padding-left"],u.layout["padding-top"],t-u.layout["padding-left"]-u.layout["padding-right"],n-u.layout["padding-top"]-u.layout["padding-bottom"],u.grid["border-radius"]);q.attr({stroke:u.grid["border-color"],"stroke-width":u.grid["border-width"],"stroke-opacity":u.grid["border-alpha"],fill:u.grid["background-color"],"fill-opacity":u.grid["background-alpha"]});q.translate(0.5,0.5);s=u.layout["padding-left"]+u.grid["border-width"]+u.grid["padding-left"];r=n-u.layout["padding-bottom"]-u.grid["border-width"]-u.grid["padding-bottom"];p["bottom-left"]=[s,r];r=u.layout["padding-top"]+u.grid["border-width"]+u.grid["padding-top"];p["top-left"]=[s,r];s=t-u.layout["padding-right"]-u.grid["border-width"]-u.grid["padding-right"];r=p["top-left"][1];p["top-right"]=[s,r];r=p["bottom-left"][1];p["bottom-right"]=[s,r];p.width=p["top-right"][0]-p["top-left"][0];p.height=p["bottom-right"][1]-p["top-right"][1];return p};b.draw_axis_background=function(r,C,n){if(!r){return h("Paper is empty.")}var l=e(n),o={},z=r.width,m=r.height,u=[],q,p;var A=r.rect(0,0,z,m);A.attr({stroke:"none",fill:l.layout["background-color"],"fill-opacity":l.layout["background-alpha"]});var s=r.rect(l.layout["padding-left"],l.layout["padding-top"],z-l.layout["padding-left"]-l.layout["padding-right"],m-l.layout["padding-top"]-l.layout["padding-bottom"],l.grid["border-radius"]);s.attr({stroke:l.grid["border-color"],"stroke-width":l.grid["border-width"],"stroke-opacity":l.grid["border-alpha"],fill:l.grid["background-color"],"fill-opacity":l.grid["background-alpha"]});s.translate(0.5,0.5);q=l.layout["padding-left"]+l.grid["border-width"]+l.grid["padding-left"]+l.grid["vertical-label-margin"]+l.grid["vertical-label-spacing"]+l.grid["vertical-label-margin"];p=m-l.layout["padding-bottom"]-l.grid["border-width"]-l.grid["padding-bottom"]-l.grid["horizontal-label-margin"]-l.grid["horizontal-label-spacing"]-l.grid["horizontal-label-margin"];o["bottom-left"]=[q,p];p=l.layout["padding-top"]+l.grid["border-width"]+l.grid["padding-top"];o["top-left"]=[q,p];q=z-l.layout["padding-right"]-l.grid["border-width"]-l.grid["padding-right"];p=o["top-left"][1];o["top-right"]=[q,p];p=o["bottom-left"][1];o["bottom-right"]=[q,p];o.width=o["top-right"][0]-o["top-left"][0];o.height=o["bottom-right"][1]-o["top-right"][1];u=[];u.push("M"+o["bottom-left"][0]+","+o["bottom-left"][1]);u.push("L"+o["top-left"][0]+","+o["top-left"][1]);var D=r.path(u.join(""));D.attr({stroke:l.grid["axis-color"],"stroke-width":l.grid["axis-width"],"stroke-opacity":l.grid["axis-alpha"]});D.translate(0.5,0.5);u=[];u.push("M"+o["bottom-left"][0]+","+o["bottom-left"][1]);u.push("L"+o["bottom-right"][0]+","+o["bottom-right"][1]);var B=r.path(u.join(""));B.attr({stroke:l.grid["axis-color"],"stroke-width":l.grid["axis-width"],"stroke-opacity":l.grid["axis-alpha"]});B.translate(0.5,0.5);var v=r.circle(o["bottom-left"][0],o["bottom-left"][1],l.grid["axis-dot-size"]);v.attr({stroke:"none",fill:l.grid["axis-color"],"fill-opacity":l.grid["axis-alpha"]});v.translate(0.5,0.5);var j=r.circle(o["top-left"][0],o["top-left"][1],l.grid["axis-dot-size"]);j.attr({stroke:"none",fill:l.grid["axis-color"],"fill-opacity":l.grid["axis-alpha"]});j.translate(0.5,0.5);var t=r.circle(o["bottom-right"][0],o["bottom-right"][1],l.grid["axis-dot-size"]);t.attr({stroke:"none",fill:l.grid["axis-color"],"fill-opacity":l.grid["axis-alpha"]});t.translate(0.5,0.5);if(C.vertical_axis_name){q=o["top-left"][0]-l.grid["vertical-label-margin"]*2;p=o["top-left"][1]+l.grid["vertical-name-size"]/2;var k=r.text(q,p,C.vertical_axis_name);k.attr({"text-anchor":"end","font-weight":"bold","font-size":l.grid["vertical-name-size"],fill:l.grid["vertical-name-color"]})}if(C.horizontal_axis_name){q=o["bottom-right"][0];p=o["bottom-right"][1]+l.grid["horizontal-name-size"]/2+l.grid["horizontal-label-margin"]*2;var w=r.text(q,p,C.horizontal_axis_name);w.attr({"text-anchor":"end","font-weight":"bold","font-size":l.grid["horizontal-name-size"],fill:l.grid["horizontal-name-color"]})}return o};b.draw_legend=function(t,p,n,o){if(!t||!n){return h("Paper or Data is empty.")}var m=e(o),v=[],s,r,D,C,F;if(!m.legend["legend-enabled"]){return}var z=m.legend["width"],w=m.legend["height"];if(!z){var B,l,q=-Infinity;for(D=0;D<n.length;++D){F=n[D];B=t.text(-1000,-1000,F.label).attr({"font-size":m.legend["label-size"]}).translate(0.5,0.5);l=B.getBBox();if(l.width>q){q=l.width}}z=q+m.legend["padding-left"]+m.legend["padding-right"]+m.legend["indicator-margin-left"]+m.legend["indicator-margin-right"]+m.legend["indicator-size"]}if(!w){w=m.legend["padding-top"]+m.legend["padding-bottom"];for(D=0;D<n.length;++D){w+=m.legend["indicator-margin-top"]+m.legend["indicator-margin-bottom"]+m.legend["indicator-size"]}}switch(m.legend["legend-position"]){default:case"top-right":s=p["top-right"][0]-z-m.legend["margin-right"];r=p["top-right"][1]+m.legend["margin-top"];break;case"top-left":s=p["top-left"][0]+m.legend["margin-left"];r=p["top-right"][1]+m.legend["margin-top"];break;case"bottom-left":s=p["bottom-left"][0]+m.legend["margin-left"];r=p["bottom-left"][1]-w-m.legend["margin-bottom"];break;case"bottom-right":s=p["bottom-right"][0]-z-m.legend["margin-right"];r=p["bottom-left"][1]-w-m.legend["margin-bottom"];break}var u=t.rect(s,r,z,w,m.legend["border-radius"]).attr({stroke:m.legend["border-color"],"stroke-opacity":m.legend["border-alpha"],"stroke-width":m.legend["border-width"],fill:m.legend["background-color"],"fill-opacity":m.legend["background-alpha"]}).translate(0.5,0.5);var k=[],A=[];var H,G;s+=m.legend["padding-left"];r+=m.legend["padding-top"];for(D=0;D<n.length;++D){F=n[D];switch(F.type){default:case"box":H=t.rect(s+m.legend["indicator-margin-left"],r+m.legend["indicator-margin-top"],m.legend["indicator-size"],m.legend["indicator-size"]).attr({fill:F.color["color"],"fill-opacity":F.color["light-alpha"],stroke:F.color["color"],"stroke-opacity":F.color["dark-alpha"],"stroke-width":m.legend["indicator-border-width"]}).translate(0.5,0.5);break;case"line":v=[];v.push("M"+(s+m.legend["indicator-margin-left"])+","+(r+m.legend["indicator-margin-top"]+m.legend["indicator-size"]));v.push("L"+(s+m.legend["indicator-margin-left"]+2*m.legend["indicator-size"]/5)+","+(r+m.legend["indicator-margin-top"]+2*m.legend["indicator-size"]/5));v.push("L"+(s+m.legend["indicator-margin-left"]+3*m.legend["indicator-size"]/4)+","+(r+m.legend["indicator-margin-top"]+5*m.legend["indicator-size"]/7));v.push("L"+(s+m.legend["indicator-margin-left"]+m.legend["indicator-size"])+","+(r+m.legend["indicator-margin-top"]));H=t.path(v.join("")).attr({stroke:F.color["color"],"stroke-opacity":F.color["dark-alpha"],"stroke-width":m.legend["indicator-border-width"]}).translate(0.5,0.5);break;case"node":H=t.circle(s+m.legend["indicator-margin-left"]+m.legend["indicator-size"]/2,r+m.legend["indicator-margin-top"]+m.legend["indicator-size"]/2,m.legend["indicator-size"]/2).attr({fill:F.color["color"],"fill-opacity":F.color["dark-alpha"],stroke:F.color["color"],"stroke-opacity":F.color["dark-alpha"],"stroke-width":m.legend["indicator-border-width"]}).translate(0.5,0.5);break;case"sector":var E=m.legend["indicator-sector-angle"]*Math.PI/180;v=[];v.push("M"+(s+m.legend["indicator-margin-left"])+","+(r+m.legend["indicator-margin-top"]+m.legend["indicator-size"]));v.push("L"+(s+m.legend["indicator-margin-left"]+Math.cos(E)*m.legend["indicator-size"])+","+(r+m.legend["indicator-margin-top"]));v.push("A"+m.legend["indicator-size"]+","+m.legend["indicator-size"]+", 0, 0, 1,"+(s+m.legend["indicator-margin-left"]+m.legend["indicator-size"])+","+(r+m.legend["indicator-margin-top"]+m.legend["indicator-size"]));v.push("L"+(s+m.legend["indicator-margin-left"])+","+(r+m.legend["indicator-margin-top"]+m.legend["indicator-size"]));v.push("Z");H=t.path(v.join("")).attr({fill:F.color["color"],"fill-opacity":F.color["light-alpha"],stroke:F.color["color"],"stroke-opacity":F.color["dark-alpha"],"stroke-width":m.legend["indicator-border-width"]}).translate(0.5,0.5);break;case"circle":H=t.circle(s+m.legend["indicator-margin-left"]+m.legend["indicator-size"]/2,r+m.legend["indicator-margin-top"]+m.legend["indicator-size"]/2,m.legend["indicator-size"]/2).attr({fill:F.color["color"],"fill-opacity":F.color["light-alpha"],stroke:F.color["color"],"stroke-opacity":F.color["dark-alpha"],"stroke-width":m.legend["indicator-border-width"]}).translate(0.5,0.5);break}k.push(H);G=t.text(s+m.legend["indicator-margin-left"]+m.legend["indicator-margin-right"]+m.legend["indicator-size"],r+m.legend["indicator-margin-top"]+m.legend["indicator-size"]/2,F.label).attr({"text-anchor":"start",fill:m.legend["label-color"]?m.legend["label-color"]:F.color["color"],"fill-opacity":m.legend["label-alpha"],"font-size":m.legend["label-size"]}).translate(0.5,0.5);r+=m.legend["indicator-size"]+m.legend["indicator-margin-top"]+m.legend["indicator-margin-bottom"]}};b.draw_tooltip=function(t,r,q,v,E,z,A,n){if(v===c){return}var m=e(n);var w,l,k=0,o=0,D=0,j=0;if(f){var p=f;p.stop();p.animate({opacity:0},m.layout["speed"],function(){p.remove();delete p})}if(i){var s=i;s.stop();s.animate({opacity:0},m.layout["speed"],function(){s.remove();delete s})}if(a){var B=a;B.stop();B.animate({opacity:0},m.layout["speed"],function(){B.remove();delete B})}c=v;w=t.text(-1000,-1000,E).attr({"font-weight":m.tooltip["title-text-weight"],"font-size":m.tooltip["title-text-size"]}).translate(0.5,0.5);l=w.getBBox();k=l.width;o=l.height;w=t.text(-1000,-1000,z).attr({"font-weight":m.tooltip["content-text-weight"],"font-size":m.tooltip["content-text-size"]}).translate(0.5,0.5);l=w.getBBox();D=l.width;j=l.height;var C=(k>D)?k:D;var u=o+j;C+=m.tooltip["padding-left"]+m.tooltip["padding-right"];u+=m.tooltip["padding-top"]+m.tooltip["padding-bottom"]+m.tooltip["line-spacing"];r-=(C/2)+m.tooltip["horizontal-offset"];if(m.tooltip["vertical-offset"]<=0){q-=(u-m.tooltip["vertical-offset"])}else{q+=u+m.tooltip["vertical-offset"]}if(r<m.layout["padding-left"]){r=m.layout["padding-left"]}if(r+C>t.width-m.layout["padding-right"]){r=t.width-m.layout["padding-right"]-C}if(q<m.layout["padding-top"]){q=m.layout["padding-top"]}if(q+u>t.height-m.layout["padding-bottom"]){q=t.height-m.layout["padding-bottom"]-u}f=t.rect(r,q,C,u,m.tooltip["border-radius"]).attr({stroke:m.tooltip["border-color"],"stroke-width":m.tooltip["border-width"],"stroke-opacity":m.tooltip["border-alpha"],fill:m.tooltip["background-color"],"fill-opacity":m.tooltip["background-alpha"],opacity:0}).translate(0.5,0.5);i=t.text(r+m.tooltip["padding-left"],q+m.tooltip["padding-top"]+o/2,E).attr({fill:m.tooltip["title-text-color"]?m.tooltip["title-text-color"]:A.color,"font-size":m.tooltip["title-text-size"],"text-anchor":"start","font-weight":m.tooltip["title-text-weight"],"fill-opacity":m.tooltip["title-text-alpha"],opacity:0}).translate(0.5,0.5);a=t.text(r+m.tooltip["padding-left"],q+m.tooltip["padding-top"]+j+m.tooltip["line-spacing"]+j/2,z).attr({fill:m.tooltip["content-text-color"],"font-size":m.tooltip["content-text-size"],"text-anchor":"start","font-weight":m.tooltip["content-text-weight"],"fill-opacity":m.tooltip["content-text-alpha"],opacity:0}).translate(0.5,0.5);f.stop();i.stop();a.stop();f.animate({opacity:1},m.layout["speed"]);i.animate({opacity:1},m.layout["speed"]);a.animate({opacity:1},m.layout["speed"])};b.draw_linechart=function(m,A,af,K,W,U){if(!m||!af){return h("Paper or Data is empty.")}var G=e(K),B=[],X,V;var R=af.data,E=[],H=[],ae,ad,ac,N;var J=af.horizontal_field,n=af.vertical_field;var q,ag,I=Infinity,ai=-Infinity,S=Infinity,v=-Infinity;var O=function(j){W.call(U,this.data("info"))};var L=function(j){X=this.data("tooltip")["node_x"];V=this.data("tooltip")["node_y"];b.draw_tooltip(m,X,V,this.data("tooltip")["id"],this.data("tooltip")["title"],this.data("tooltip")["content"],this.data("tooltip")["color"],G)};for(var w in R){for(ae=0;ae<R[w]["data"].length;++ae){N=R[w]["data"][ae];if(N[J]){q=N[J]}else{q="N/A"}if(q>ai){ai=q}if(q<I){I=q}if(d(q,E)===-1){E.push(q)}if(N[n]){ag=N[n]}else{ag="N/A"}if(ag>v){v=ag}if(ag<S){S=ag}if(d(ag,H)===-1){H.push(ag)}}}S=Math.floor(S/10)*10;v=Math.ceil(v/10)*10;var Z=A["top-left"][0]+G.linechart["padding-left"];var F=(A["top-right"][0]-G.linechart["padding-right"]-Z)/(E.length-1);var ab=A["bottom-left"][1]-G.linechart["padding-bottom"];var T=(ab-A["top-left"][1]-G.linechart["padding-top"])/(v-S);var o={};var C=(ab-A["top-left"][1]-G.linechart["padding-top"])/(G.linechart["vertical-label-count"]-1);var t=Math.floor((v-S)/(G.linechart["vertical-label-count"]-1));B=[];X=A["top-left"][0]-G.linechart["vertical-bar-width"];V=ab;var r=S;for(ae=0;ae<G.linechart["vertical-label-count"];++ae){B.push("M"+X+","+V+"L"+A["top-left"][0]+","+V);m.path(B.join("")).attr({stroke:G.grid["axis-color"],"stroke-opacity":G.grid["axis-alpha"],"stroke-width":G.grid["axis-width"]}).translate(0.5,0.5);m.text(X-G.linechart["vertical-bar-width"],V,r).attr({"text-anchor":"end",fill:G.grid["vertical-label-color"],"font-size":G.grid["vertical-label-size"]}).translate(0.5,0.5);V-=C;r+=t}var u;B=[];X=Z;V=A["bottom-right"][1]+G.grid["horizontal-name-size"]/2+G.grid["horizontal-label-margin"]*2;for(ae=0;ae<E.length;++ae){B.push("M"+X+","+A["bottom-left"][1]);B.push("L"+X+","+A["top-left"][1]);o[E[ae]]=X;m.text(X,V,E[ae]).attr({"text-anchor":"middle","font-size":G.grid["horizontal-label-size"],fill:G.grid["horizontal-label-color"]}).translate(0.5,0.5);X+=F}u=m.path(B.join(""));u.attr({stroke:G.grid["grid-color"],"stroke-dasharray":"--..","stroke-linecap":"butt","stroke-width":G.grid["grid-width"],"stroke-opacity":G.grid["grid-alpha"]});u.translate(0.5,0.5);var Q=0,M;var Y=[];for(var w in R){var l,D,s,ah=[];B=[];M=G.color[(Q%G.color.length)];for(ae=0;ae<R[w]["data"].length;++ae){N=R[w]["data"][ae];X=o[N[J]];V=ab-N[n]*T+G.linechart["circle-radius"];if(ae===0){B.push("M"+X+","+V)}else{B.push("L"+X+","+V)}ah.push({x:X,y:V,v_value:N[n],h_value:N[J],data:N})}l=m.path(B.join(""));l.attr({stroke:M.color,"stroke-opacity":M["light-alpha"],"stroke-width":G.linechart["line-width"]}).translate(0.5,0.5);s=m.text(X+G.linechart["circle-radius"]*2,V,R[w]["name"]);s.attr({fill:M.color,"text-anchor":"start","font-size":G.linechart["label-size"]}).translate(0.5,0.5);for(ae=0;ae<ah.length;++ae){if(G.linechart["custom-circle"]){D=m.image(G.linechart["custom-circle"],ah[ae]["x"]-G.linechart["circle-radius"],ah[ae]["y"]-G.linechart["circle-radius"],G.linechart["circle-radius"]*2,G.linechart["circle-radius"]*2).attr({cursor:"pointer"}).translate(0.5,0.5)}else{D=m.circle(ah[ae]["x"],ah[ae]["y"],G.linechart["circle-radius"]).attr({stroke:M.color,"stroke-opacity":M["dark-alpha"],"stroke-width":G.linechart["line-width"],fill:M.color}).translate(0.5,0.5)}if(W&&typeof(W)==="function"){D.data("info",{data:ah[ae]["data"],x:ah[ae]["x"],y:ah[ae]["y"],v_value:ah[ae]["v_value"],h_value:ah[ae]["h_value"]});D.click(O)}if(af.tooltip_title||af.tooltip_content){var P=af.tooltip_title;var z=af.tooltip_content;for(var aa in ah[ae]["data"]){P=P.replace("{"+aa+"}",ah[ae]["data"][aa]);z=z.replace("{"+aa+"}",ah[ae]["data"][aa])}D.data("tooltip",{id:w+ae,title:P,content:z,color:M,node_x:ah[ae]["x"],node_y:ah[ae]["y"]});D.hover(L)}}Y.push({label:R[w]["name"],color:M,type:"line"});Q++}b.draw_legend(m,A,Y,G)};b.draw_barchart=function(m,z,ah,J,W,U){if(!m||!ah){return h("Paper or Data is empty.")}var F=e(J),A=[],X,V,ad=0;var Q=ah.data,D=[],G=[],ag,af,ae,M;var I=ah.horizontal_field,n=ah.vertical_field;var q,ai,H=Infinity,aj=-Infinity,S=Infinity,u=-Infinity;var N=function(j){W.call(U,this.data("info"))};var K=function(j){X=this.data("tooltip")["bar_top_x"];V=this.data("tooltip")["bar_top_y"];b.draw_tooltip(m,X,V,this.data("tooltip")["id"],this.data("tooltip")["title"],this.data("tooltip")["content"],this.data("tooltip")["color"],F)};for(var v in Q){for(ag=0;ag<Q[v]["data"].length;++ag){M=Q[v]["data"][ag];if(M[I]){q=M[I]}else{q="N/A"}if(q>aj){aj=q}if(q<H){H=q}if(d(q,D)===-1){D.push(q)}if(M[n]){ai=M[n]}else{ai="N/A"}if(ai>u){u=ai}if(ai<S){S=ai}if(d(ai,G)===-1){G.push(ai)}}++ad}S=Math.floor(S/10)*10;u=Math.ceil(u/10)*10;var aa=z["top-left"][0]+F.barchart["padding-left"];var ac=z["bottom-left"][1]-F.barchart["padding-bottom"];var T=(ac-z["top-left"][1]-F.barchart["padding-top"])/(u-S);var o={};var B=(ac-z["top-left"][1]-F.barchart["padding-top"])/(F.barchart["vertical-label-count"]-1);var s=Math.floor((u-S)/(F.barchart["vertical-label-count"]-1));A=[];X=z["top-left"][0]-F.barchart["vertical-bar-width"];V=ac;var r=S;for(ag=0;ag<F.barchart["vertical-label-count"];++ag){A.push("M"+X+","+V+"L"+z["top-left"][0]+","+V);m.path(A.join("")).attr({stroke:F.grid["axis-color"],"stroke-opacity":F.grid["axis-alpha"],"stroke-width":F.grid["axis-width"]}).translate(0.5,0.5);m.text(X-F.barchart["vertical-bar-width"],V,r).attr({"text-anchor":"end",fill:F.grid["vertical-label-color"],"font-size":F.grid["vertical-label-size"]}).translate(0.5,0.5);V-=B;r+=s}var E=(z.width-F.barchart["padding-left"]-F.barchart["padding-right"]-(D.length-1)*F.barchart["group-margin"])/D.length;var R=(E-(ad-1)*F.barchart["bar-margin"])/ad;var t;A=[];X=aa+E/2;V=z["bottom-right"][1]+F.grid["horizontal-name-size"]/2+F.grid["horizontal-label-margin"]*2;for(ag=0;ag<D.length;++ag){A.push("M"+X+","+z["bottom-left"][1]);A.push("L"+X+","+z["top-left"][1]);o[D[ag]]=X-E/2;m.text(X,V,D[ag]).attr({"text-anchor":"middle","font-size":F.grid["horizontal-label-size"],fill:F.grid["horizontal-label-color"]}).translate(0.5,0.5);X+=E+F.barchart["group-margin"]}t=m.path(A.join(""));t.attr({stroke:F.grid["grid-color"],"stroke-dasharray":"--..","stroke-linecap":"butt","stroke-width":F.grid["grid-width"],"stroke-opacity":F.grid["grid-alpha"]});t.translate(0.5,0.5);var P=0,L,l=[],Z;var Y=[];for(var v in Q){var C;L=F.color[(P%F.color.length)];for(ag=0;ag<Q[v]["data"].length;++ag){M=Q[v]["data"][ag];X=o[M[I]]+(P)*(R+F.barchart["bar-margin"]);V=ac-M[n]*T;Z=m.rect(X,V,R,z["bottom-left"][1]-V-1);Z.attr({stroke:L.color,"stroke-opacity":L["dark-alpha"],"stroke-width":F.barchart["line-width"],fill:L.color,"fill-opacity":L["light-alpha"]}).translate(0.5,0.5);l.push(Z);if(W&&typeof(W)==="function"){Z.data("info",{x:X,y:V,h_value:M[I],v_value:M[n],data:M});Z.click(N)}if(ah.tooltip_title||ah.tooltip_content){var O=ah.tooltip_title;var w=ah.tooltip_content;for(var ab in M){O=O.replace("{"+ab+"}",M[ab]);w=w.replace("{"+ab+"}",M[ab])}Z.data("tooltip",{id:v+ag,title:O,content:w,color:L,bar_top_x:X,bar_top_y:V});Z.hover(K)}}Y.push({label:Q[v]["name"],color:L,type:"box"});P++}b.draw_legend(m,z,Y,F);for(ag=0;ag<l.length;++ag){(function(j){j.mouseover(function(){j.stop().animate({"fill-opacity":F.color[0]["dark-alpha"]},F.layout["speed"],">")});j.mouseout(function(){j.stop().animate({"fill-opacity":F.color[0]["light-alpha"]},F.layout["speed"],"<")})})(l[ag])}};b.draw_bubblechart=function(k,v,ac,I,U,Q){if(!k||!ac){return h("Paper or Data is empty.")}var F=e(I),w=[],ab,W,T,t,L;var G=Infinity,af=-Infinity,O=Infinity,s=-Infinity,l=-Infinity,K=Infinity;var M=function(p){U.call(Q,this.data("info"))};var J=function(p){W=this.data("tooltip")["x"];T=this.data("tooltip")["y"];b.draw_tooltip(k,W,T,this.data("tooltip")["id"],this.data("tooltip")["title"],this.data("tooltip")["content"],this.data("tooltip")["color"],F)};for(ab=0;ab<ac.data.length;++ab){L=ac.data[ab];if(L[ac.horizontal_field]>af){af=L[ac.horizontal_field]}if(L[ac.horizontal_field]<G){G=L[ac.horizontal_field]}if(L[ac.vertical_field]>s){s=L[ac.vertical_field]}if(L[ac.vertical_field]<O){O=L[ac.vertical_field]}if(L[ac.size_field]>l){l=L[ac.size_field]}if(L[ac.size_field]<K){K=L[ac.size_field]}}G=Math.floor(G/10)*10;af=Math.ceil(af/10)*10;O=Math.floor(O/10)*10;s=Math.ceil(s/10)*10;var Y=v["top-left"][0]+F.bubblechart["padding-left"];var E=(v["top-right"][0]-F.bubblechart["padding-right"]-Y)/(af-G);var aa=v["bottom-left"][1]-F.bubblechart["padding-bottom"];var P=(aa-v["top-left"][1]-F.bubblechart["padding-top"])/(s-O);var ae=F.bubblechart["circle-min-radius"];var C=(F.bubblechart["circle-max-radius"]-ae)/(l-K);var o,ad,B,V,D,A,R;var X=[],H=[],m=[];for(ab=0;ab<ac.data.length;++ab){L=ac.data[ab];o=L[ac.horizontal_field];ad=L[ac.vertical_field];B=L[ac.size_field];V=L[ac.label_field];D=F.color[(ab%F.color.length)];t=ae+B*C;W=Y+o*E;T=aa-(ad-O)*P;A=k.circle(W,T,t).attr({fill:D.color,"fill-opacity":D["light-alpha"],stroke:D.color,"stroke-opacity":D["dark-alpha"],"stroke-width":F.bubblechart["circle-border-width"]}).translate(0.5,0.5);R=k.text(W,T,V).attr({fill:D.color,"font-size":F.bubblechart["label-size"],"text-anchor":"middle"}).translate(0.5,0.5);A.data("data",L);R.data("data",L);H.push(A);m.push(R);X.push({label:V,color:D,type:"circle"});if(U&&typeof(U)==="function"){A.data("info",{x:W,y:T,v_value:ad,h_value:o,data:L});A.click(M);R.data("info",{x:W,y:T,v_value:ad,h_value:o,data:L});R.click(M)}if(ac.tooltip_title||ac.tooltip_content){var N=ac.tooltip_title;var u=ac.tooltip_content;for(var Z in L){N=N.replace("{"+Z+"}",L[Z]);u=u.replace("{"+Z+"}",L[Z])}A.data("tooltip",{id:ab,title:N,content:u,color:D,x:W,y:T-t});A.hover(J);R.data("tooltip",{id:ab,title:N,content:u,color:D,x:W,y:T-t});R.hover(J)}}b.draw_legend(k,v,X,F);var z=(aa-v["top-left"][1]-F.bubblechart["padding-top"])/(F.bubblechart["vertical-label-count"]-1);var r=(s-O)/(F.bubblechart["vertical-label-count"]-1);w=[];W=v["top-left"][0]-F.bubblechart["vertical-bar-width"];T=aa;var q=O;for(ab=0;ab<F.bubblechart["vertical-label-count"];++ab){w.push("M"+W+","+T+"L"+v["top-left"][0]+","+T);k.path(w.join("")).attr({stroke:F.grid["axis-color"],"stroke-opacity":F.grid["axis-alpha"],"stroke-width":F.grid["axis-width"]}).translate(0.5,0.5);k.text(W-F.bubblechart["vertical-bar-width"],T,q.toFixed(2)).attr({"text-anchor":"end",fill:F.grid["vertical-label-color"],"font-size":F.grid["vertical-label-size"]}).translate(0.5,0.5);T-=z;q+=r}var S=(v["top-right"][0]-F.bubblechart["padding-right"]-Y)/(F.bubblechart["vertical-label-count"]-1);var j=(af-G)/(F.bubblechart["vertical-label-count"]-1);w=[];W=Y;T=v["bottom-left"][1]+F.bubblechart["horizontal-bar-width"];var n=G;for(ab=0;ab<F.bubblechart["horizontal-label-count"];++ab){w.push("M"+W+","+T+"L"+W+","+v["bottom-left"][1]);k.path(w.join("")).attr({stroke:F.grid["axis-color"],"stroke-opacity":F.grid["axis-alpha"],"stroke-width":F.grid["axis-width"]}).translate(0.5,0.5);k.text(W,T+F.bubblechart["horizontal-bar-width"]*2,n.toFixed(2)).attr({fill:F.grid["horizontal-label-color"],"font-size":F.grid["horizontal-label-size"]}).translate(0.5,0.5);W+=S;n+=j}};b.draw_piechart=function(l,r,ad,I,R,O){if(!l||!ad){return h("Paper or Data is empty.")}var G=e(I),s=[],U,Q,ab,K,W;var C=G.piechart["hole-radius"];var E=r["top-left"][0]+r.width/2+G.piechart["horizontal-offset"];var D=r["top-left"][1]+r.height/2+G.piechart["vertical-offset"];var L=function(p){R.call(O,this.data("info"))};var J=function(p){U=this.data("tooltip")["x"];Q=this.data("tooltip")["y"];b.draw_tooltip(l,U,Q,this.data("tooltip")["id"],this.data("tooltip")["title"],this.data("tooltip")["content"],this.data("tooltip")["color"],G)};if(r.width>r.height){W=Math.floor(r.height/2)*G.piechart["size-factor"]}else{W=Math.floor(r.width/2)*G.piechart["size-factor"]}var n=-Infinity,N=Infinity,m=0;for(ab=0;ab<ad.data.length;++ab){K=ad.data[ab];if(K[ad.value_field]>n){n=K[ad.value_field]}if(K[ad.value_field]<N){N=K[ad.value_field]}m+=K[ad.value_field]}var H=function(al,aj,x,p,am,ai,ak){var an=Math.PI/180,ah=al+x*Math.cos(-am*an),y=al+x*Math.cos(-ai*an),ap=aj+x*Math.sin(-am*an),ao=aj+x*Math.sin(-ai*an);z=al+p*Math.cos(-am*an),v=al+p*Math.cos(-ai*an),af=aj+p*Math.sin(-am*an),ae=aj+p*Math.sin(-ai*an);if(p>0){return l.path(["M",z,af,"L",ah,ap,"A",x,x,0,+(ai-am>180),0,y,ao,"L",v,ae,"A",p,p,0,-(ai-am>180),1,z,af]).attr(ak)}else{return l.path(["M",al,aj,"L",ah,ap,"A",x,x,0,+(ai-am>180),0,y,ao,"z"]).attr(ak)}};var u=360/m;var w,o=0,F,Y=[],B=[],t=[],k;var A,ag,z,af,v,ae,aa;var T,Z,S;var V=[];for(ab=0;ab<ad.data.length;++ab){K=ad.data[ab][ad.value_field];w=u*K;F=G.color[(ab%G.color.length)];T=H(E,D,W,C,o,o+w,{fill:F.color,"fill-opacity":F["light-alpha"],stroke:F.color,"stroke-opacity":F["dark-alpha"],"stroke-width":G.piechart["sector-border-width"]}).translate(0.5,0.5);T.data("color-alpha",F["light-alpha"]);T.data("index",ab);Y.push(T);if(R&&typeof(R)==="function"){T.data("info",{start:o,angle:w,value:ad.data[ab][ad.value_field],data:ad.data[ab]});T.click(L)}V.push({label:ad.data[ab][ad.label_field],color:F,type:"sector"});k=-(o+w/2)*Math.PI/180;U=E+(W+G.piechart["label-distance"])*Math.cos(k);Q=D+(W+G.piechart["label-distance"])*Math.sin(k);A=E+(W+G.piechart["label-distance"]+G.piechart["label-bar-length1"])*Math.cos(k);ag=D+(W+G.piechart["label-distance"]+G.piechart["label-bar-length1"])*Math.sin(k);if(U>E){z=A+G.piechart["label-bar-length2"]}else{z=A-G.piechart["label-bar-length2"]}af=ag;s=[];s.push("M"+U+","+Q);s.push("L"+A+","+ag);s.push("L"+z+","+af);Z=l.path(s.join("")).attr({stroke:G.piechart["label-line-color"],"stroke-opacity":G.piechart["label-line-color"],"stroke-width":G.piechart["label-line-width"]}).translate(0.5,0.5);B.push(Z);if(U>E){v=z+G.piechart["label-distance"];aa="start"}else{v=z-G.piechart["label-distance"];aa="end"}ae=af;S=l.text(v,ae,ad.data[ab][ad.label_field]).attr({"text-anchor":aa,fill:F.color,"font-size":G.piechart["label-size"]}).translate(0.5,0.5);t.push(S);if(ad.tooltip_title||ad.tooltip_content){var M=ad.tooltip_title;var q=ad.tooltip_content;for(var X in ad.data[ab]){M=M.replace("{"+X+"}",ad.data[ab][X]);q=q.replace("{"+X+"}",ad.data[ab][X])}T.data("tooltip",{id:ab,title:M,content:q,color:F,x:E+(W/2)*Math.cos(k),y:D+(W/2)*Math.sin(k)});T.hover(J)}o+=w}b.draw_legend(l,r,V,G);var ac=Raphael.animation({transform:"s1.1 1.1 "+E+" "+D},G.layout["speed"],">");var P=Raphael.animation({transform:""},G.layout["speed"],"<");var j;for(ab=0;ab<Y.length;++ab){(function(p){p.mouseover(function(){Z=B[p.data("index")];if(Z){Z.stop().animate(ac)}S=t[p.data("index")];if(S){S.stop().animate(ac)}j=ac;j.anim["100"]["fill-opacity"]=1;p.stop().animate(j);delete j.anim["100"]["fill-opacity"]});p.mouseout(function(){Z=B[p.data("index")];if(Z){Z.stop().animate(P)}S=t[p.data("index")];if(S){S.stop().animate(P)}j=P;j.anim["100"]["fill-opacity"]=p.data("color-alpha");p.stop().animate(j);delete j.anim["100"]["fill-opacity"]})})(Y[ab])}};b.draw_radarchart=function(E,A,T,w,u,B){if(!E||!T){return h("Paper or Data is empty.")}var r=e(w),H=[],F=[],D,C,N,L,O,s,S=Math.PI/180;var o=A["top-left"][0]+A.width/2+r.radarchart["horizontal-offset"];var n=A["top-left"][1]+A.height/2+r.radarchart["vertical-offset"];var Q=function(j){u.call(B,this.data("info"))};var q=function(j){D=this.data("tooltip")["x"];C=this.data("tooltip")["y"];b.draw_tooltip(E,D,C,this.data("tooltip")["id"],this.data("tooltip")["title"],this.data("tooltip")["content"],this.data("tooltip")["color"],r)};if(A.width>A.height){s=Math.floor(A.height/2)*r.radarchart["size-factor"]}else{s=Math.floor(A.width/2)*r.radarchart["size-factor"]}var l=0;var G=360/T.value_fields.length;var P={},R={};for(N=0;N<T.value_fields.length;++N){P[T.value_fields[N]]={v_max:-Infinity,v_min:Infinity};R[T.value_fields[N]]={angle:l};l+=G}for(N=0;N<T.data.length;++N){for(L=0;L<T.value_fields.length;++L){O=T.data[N][T.value_fields[L]];if(O>P[T.value_fields[L]]["v_max"]){P[T.value_fields[L]]["v_max"]=O}if(O<P[T.value_fields[L]]["v_min"]){P[T.value_fields[L]]["v_min"]=O}}}E.circle(o,n,s).attr({stroke:r.radarchart["outer-border-color"],"stroke-width":r.radarchart["outer-border-width"],"stroke-opacity":r.radarchart["outer-border-alpha"],fill:r.radarchart["outer-background-color"],"fill-opacity":r.radarchart["outer-background-alpha"]}).translate(0.5,0.5);H=[];F=[];var m=0;for(N=0;N<T.value_fields.length;++N){if(N===0){H.push("M")}else{H.push("L")}D=o+s*Math.sin(R[T.value_fields[N]]["angle"]*S);C=n-s*Math.cos(R[T.value_fields[N]]["angle"]*S);R[T.value_fields[N]]["end-x"]=D;R[T.value_fields[N]]["end-y"]=C;H.push(D+","+C);F.push("M"+o+","+n+"L"+D+","+C);D=o+(s+r.radarchart["label-distance"])*Math.sin(R[T.value_fields[N]]["angle"]*S);C=n-(s+r.radarchart["label-distance"])*Math.cos(R[T.value_fields[N]]["angle"]*S);R[T.value_fields[N]]["label-x"]=D;R[T.value_fields[N]]["label-y"]=C;if(r.radarchart["label-rotation"]){m=R[T.value_fields[N]]["angle"];if(R[T.value_fields[N]]["angle"]>90&&R[T.value_fields[N]]["angle"]<270){m+=180}}E.text(D,C,T.value_fields[N]).attr({"font-size":r.radarchart["label-size"],fill:r.radarchart["label-color"],transform:"r"+m}).translate(0.5,0.5);P[T.value_fields[N]]["v_unit"]=(s-r.radarchart["circle-min-radius"])/(P[T.value_fields[N]]["v_max"]-P[T.value_fields[N]]["v_min"])}H.push("z");E.path(H.join("")).attr({stroke:r.radarchart["inner-border-color"],"stroke-width":r.radarchart["inner-border-width"],"stroke-opacity":r.radarchart["inner-border-alpha"],fill:r.radarchart["inner-background-color"],"fill-opacity":r.radarchart["inner-background-alpha"]}).translate(0.5,0.5);E.path(F.join("")).attr({stroke:r.radarchart["axis-color"],"stroke-width":r.radarchart["axis-width"],"stroke-opacity":r.radarchart["axis-alpha"]}).translate(0.5,0.5);var I=0,z,v,k=[],M,t=[];for(N=0;N<T.data.length;++N){z=r.color[(N%r.color.length)];H=[];for(L=0;L<T.value_fields.length;++L){v=T.data[N][T.value_fields[L]];I=r.radarchart["circle-min-radius"]+P[T.value_fields[L]]["v_unit"]*(v-P[T.value_fields[L]]["v_min"]);if(!I){continue}if(L===0){H.push("M")}else{H.push("L")}D=o+I*Math.sin(R[T.value_fields[L]]["angle"]*S);C=n-I*Math.cos(R[T.value_fields[L]]["angle"]*S);H.push(D+","+C)}H.push("z");M=E.path(H.join("")).attr({stroke:z.color,"stroke-width":r.radarchart["circle-border-width"],"stroke-opacity":z["dark-alpha"],fill:z.color,"fill-opacity":r.radarchart["circle-background-alpha"]}).translate(0.5,0.5);M.data("color-alpha",r.radarchart["circle-background-alpha"]);k.push(M);if(T.data[N][T.name_field]){t.push({label:T.data[N][T.name_field],color:z,type:"circle"})}if(u&&typeof(u)==="function"){J.data("info",{name:T.data[N][T.name_field],data:T.data[N]});J.click(Q)}if(T.tooltip_title||T.tooltip_content){var U=T.tooltip_title;var K=T.tooltip_content;for(var J in T.data[N]){U=U.replace("{"+J+"}",T.data[N][J]);K=K.replace("{"+J+"}",T.data[N][J])}M.data("tooltip",{id:N,title:U,content:K,color:z,x:D,y:C});M.hover(q)}}b.draw_legend(E,A,t,r);for(N=0;N<k.length;++N){(function(j){j.mouseover(function(){j.animate({"fill-opacity":0.618},r.layout["speed"],"<")});j.mouseout(function(){j.animate({"fill-opacity":j.data("color-alpha")},r.layout["speed"],">")})})(k[N])}};b.draw_smithgraph=function(m,t,r,l){if(!m||!r){return h("Paper or Data is empty.")}var B=e(l),k=[],s=[],z,w,q,p,A,u,v=Math.PI/180;var o=t["top-left"][0]+t.width/2+B.smithgraph["horizontal-offset"];var n=t["top-left"][1]+t.height/2+B.smithgraph["vertical-offset"];if(t.width>t.height){u=Math.floor(t.height/2)*B.smithgraph["size-factor"]}else{u=Math.floor(t.width/2)*B.smithgraph["size-factor"]}};b.draw_heatmap=function(A,u,R,s,q,v){if(!A||!R){return h("Paper or Data is empty.")}var m=e(s),B=[],z,w,K,J,N;var O=function(j){q.call(v,this.data("info"))};var l=function(j){z=this.data("tooltip")["x"];w=this.data("tooltip")["y"];b.draw_tooltip(A,z,w,this.data("tooltip")["id"],this.data("tooltip")["title"],this.data("tooltip")["content"],this.data("tooltip")["color"],m)};var I=-Infinity,E=Infinity;for(K=0;K<R.data.length;++K){N=R.data[K];if(N[R.value_field]>I){I=N[R.value_field]}if(N[R.value_field]<E){E=N[R.value_field]}}var o=1,n=1;if(m.heatmap["horizontal_count"]>0){o=m.heatmap["horizontal_count"];n=Math.ceil(R.data.length/o)}else{if(m.heatmap["vertical_count"]>0){n=m.heatmap["vertical_count"];o=Math.ceil(R.data.length/n)}else{o=Math.floor(Math.sqrt(R.data.length));n=o}}var M=1,L=1;M=(u.width-((o-1)*m.heatmap["horizontal_margin"]))/o;L=(u.height-((n-1)*m.heatmap["vertical_margin"]))/n;var t,P,r,k,Q;if(m.heatmap["color"]&&m.heatmap["color"].length>0){P=m.heatmap["color"]}else{P=m.color}w=u["top-left"][1];index=0;var C=false,G=[],F=[];Q=undefined;for(J=0;J<n;++J){z=u["top-left"][0];for(K=0;K<o;++K){if(!R.data[index]){C=true;break}r=R.data[index][R.value_field];t=P[Math.floor((r-E)*((P.length-1)/(I-E)))];k=A.rect(z,w,M,L).attr({fill:t.color,"fill-opacity":t["dark-alpha"],stroke:t.color,"stroke-opacity":t["dark-alpha"],"stroke-width":m.heatmap["box-border-width"]}).translate(0.5,0.5);G.push(k);if(M>m.heatmap["label-size"]&&L>m.heatmap["label-size"]){Q=A.text(z+M/2,w+L/2,R.data[index][R.label_field]).attr({fill:m.heatmap["label-color"],"fill-opacity":m.heatmap["label-alpha"],"font-size":m.heatmap["label-size"]}).translate(0.5,0.5);F.push(Q)}if(q&&typeof(q)==="function"){k.data("info",{x:z,y:w,data:R.data[index]});Q.data("info",{x:z,y:w,data:R.data[index]});k.click(O);Q.click(O)}if(R.tooltip_title||R.tooltip_content){var S=R.tooltip_title;var H=R.tooltip_content;for(var D in R.data[index]){S=S.replace("{"+D+"}",R.data[index][D]);H=H.replace("{"+D+"}",R.data[index][D])}k.data("tooltip",{id:index,title:S,content:H,color:t,x:z+M/2,y:w});k.hover(l);Q.data("tooltip",{id:index,title:S,content:H,color:t,x:z+M/2,y:w});Q.hover(l)}z+=M+m.heatmap["horizontal_margin"];++index}if(C){break}w+=L+m.heatmap["vertical_margin"]}};b.draw_tagcloud=function(l,B,ac,L,W,T){if(!l||!ac){return h("Paper or Data is empty.")}var K=e(L),C=[],X,V,aa,Z,N;var D=K.tagcloud["levels"]?K.tagcloud["levels"]:8;var O=function(j){W.call(T,this.data("info"))};var M=function(j){X=this.data("tooltip")["x"];V=this.data("tooltip")["y"];b.draw_tooltip(l,X,V,this.data("tooltip")["id"],this.data("tooltip")["title"],this.data("tooltip")["content"],this.data("tooltip")["color"],K)};var u=-Infinity,R=Infinity,t=0;for(aa=0;aa<ac.data.length;++aa){N=ac.data[aa];if(N[ac.value_field]>u){u=N[ac.value_field]}if(N[ac.value_field]<R){R=N[ac.value_field]}t+=N[ac.text_field].length}var n=[],o,k,z;for(aa=0;aa<ac.data.length;++aa){N=ac.data[aa];o=Math.floor((D-1)*(N[ac.value_field]-R)/(u-R));this_size=K.tagcloud["text-min-size"]+Math.floor(o*(K.tagcloud["text-max-size"]-K.tagcloud["text-min-size"])/D);k=l.text(-1000,-1000,N[ac.text_field]).attr({"font-size":this_size}).translate(0.5,0.5);z=k.getBBox();n.push({value:N[ac.value_field],text:N[ac.text_field],size:this_size,length:N[ac.text_field].length,level:o,width:z.width,height:z.height,index:aa})}var F=B["top-left"][0]+B.width/2;var E=B["top-left"][1]+B.height/2;var ab=K.tagcloud["row-count"],S=[];for(aa=0;aa<ab;++aa){S.push({node:[]})}if(ab%2===0){E-=K.tagcloud["text-max-size"]/2}n.sort(function(p,j){return j.size-p.size});for(aa=0;aa<n.length;++aa){S[aa%S.length]["node"].push(n[aa])}var q=[],U,ad=[];var m=0,J,I,w,v,H,G;var s,r,Q=0;for(aa=0;aa<S.length;++aa){if(aa===0){X=F;V=E;J=V;I=V}else{X=F;if(aa%2===0){V=J-m;J=V}else{V=I+m;I=V}}w=0;v=0;H=0;G=0;m=-Infinity;for(Z=0;Z<S[aa]["node"].length;++Z){N=S[aa]["node"][Z];this_color=K.tagcloud["color"][Math.floor((K.tagcloud["color"].length-1)*(N.level/(D-1)))];if(Z===0){s=X;r=V;H=N.width+K.tagcloud["horizontal_margin"];G=N.width+K.tagcloud["horizontal_margin"]}else{if(Z%2===0){w-=H/2+N.width/2;s=X+w;H=N.width+K.tagcloud["horizontal_margin"]}else{v+=G/2+N.width/2;s=X+v;G=N.width+K.tagcloud["horizontal_margin"]}}if(N.height>m){m=N.height+K.tagcloud["vertical_margin"]}ad.push({x:s,y:r,item:N,color:this_color,data:ac.data[N.index]});Q++}}for(aa=ad.length-1;aa>=0;--aa){U=l.text(ad[aa]["x"],ad[aa]["y"],ad[aa]["item"]["text"]).attr({"font-size":ad[aa]["item"]["size"],fill:ad[aa]["color"]["color"],"fill-opacity":ad[aa]["color"]["dark-alpha"],"text-anchor":"middle"}).translate(0.5,0.5);q.push(U);if(W&&typeof(W)==="function"){U.data("info",{data:ad[aa]["data"],item:ad[aa]["item"],x:ad[aa]["x"],y:ad[aa]["y"]});U.click(O)}if(ac.tooltip_title||ac.tooltip_content){var P=ac.tooltip_title;var A=ac.tooltip_content;for(var Y in ad[aa]["data"]){P=P.replace("{"+Y+"}",ad[aa]["data"][Y]);A=A.replace("{"+Y+"}",ad[aa]["data"][Y])}U.data("tooltip",{id:aa,title:P,content:A,color:this_color,x:ad[aa]["x"],y:ad[aa]["y"]});U.hover(M)}}for(aa=0;aa<q.length;++aa){(function(j){j.mouseover(function(){j.animate({transform:"s1.5"},K.layout["speed"],">")});j.mouseout(function(){j.animate({transform:""},K.layout["speed"],"<")})})(q[aa])}};var d=function(k,l){if(typeof(l)==="object"&&(l instanceof Array)){for(var j=0;j<l.length;++j){if(k==l[j]){return j}}}return -1};var e=function(k){if(!k){return b.options}var j={},m,l;for(m in b.options){if(typeof(b.options[m])==="object"&&(b.options[m] instanceof Array)){j[m]=[]}else{j[m]={}}for(l in b.options[m]){j[m][l]=b.options[m][l]}}for(m in k){for(l in k[m]){j[m][l]=k[m][l]}}return j};var g=function(k){var j=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};if(k==="long"){return(j()+j()+"-"+j()+"-"+j()+"-"+j()+"-"+j()+j()+j())}else{return(j()+j())}};var h=function(j){if(console&&typeof(console.log)==="function"){console.log(j)}else{alert(j)}};b.global_option=function(j){b.options=e(j)};b.version=function(){return"0.1.0"};b.enable_logo=function(){b.options.layout["logo-enabled"]=true};window.InfoViz=b})();