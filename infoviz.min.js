(function(d){if(d.InfoViz){return}d.InfoViz={};d.InfoViz.options={layout:{"padding-top":1,"padding-right":1,"padding-bottom":1,"padding-left":1,"background-color":"#FFF","background-alpha":1,"logo-enabled":false,"logo-width":50,"logo-height":23,"logo-position":"top-right",speed:300,"box-border-width":1,"box-border-color":"#AAA","box-border-alpha":1,"box-background-color":"#F9F9F9","box-background-alpha":0.9},grid:{"padding-top":10,"padding-right":10,"padding-bottom":10,"padding-left":10,"grid-width":1,"grid-color":"#CCC","grid-alpha":0.5,"axis-width":1,"axis-color":"#999","axis-alpha":1,"axis-dot-size":2.4,"border-width":1,"border-color":"#AAA","border-alpha":1,"border-radius":4,"background-color":"#FFF","background-alpha":1,"vertical-label-margin":5,"vertical-label-spacing":40,"vertical-label-size":12,"vertical-label-color":"#555","vertical-name-size":12,"vertical-name-color":"#000","horizontal-label-margin":5,"horizontal-label-spacing":10,"horizontal-label-size":12,"horizontal-label-color":"#555","horizontal-name-size":12,"horizontal-name-color":"#000"},linechart:{"padding-top":30,"padding-right":90,"padding-bottom":20,"padding-left":30,"line-width":2,"circle-radius":5,"label-size":12,"vertical-label-count":10,"vertical-bar-width":5},bubblechart:{"padding-top":40,"padding-right":100,"padding-bottom":40,"padding-left":60,"circle-border-width":2,"circle-min-radius":15,"circle-max-radius":40,"label-size":12,"horizontal-label-count":10,"horizontal-bar-width":5,"vertical-label-count":5,"vertical-bar-width":5},barchart:{"padding-top":30,"padding-right":30,"padding-bottom":20,"padding-left":30,"group-margin":40,"bar-margin":4,"vertical-label-count":10,"vertical-bar-width":5},piechart:{"sector-size-factor":0.9,"sector-border-width":1,"label-distance":5,"label-line-width":1,"label-line-color":"#555","label-line-alpha":1,"label-size":11,"label-bar-length1":5,"label-bar-length2":10,"hole-radius":0},radarchart:{"outer-border-width":1,"outer-border-color":"#999","outer-border-alpha":1,"outer-background-color":"#FFF","outer-background-alpha":1,"inner-border-width":1,"inner-border-color":"#CCC","inner-border-alpha":1,"inner-background-color":"#F9F9F9","inner-background-alpha":1,"axis-width":2,"axis-color":"#999","axis-alpha":1,"circle-border-width":2,"circle-background-alpha":0.1,"circle-min-radius":30,"label-distance":15,"label-color":"#555","label-size":12,"label-rotation":false},heatmap:{horizontal_margin:4,vertical_margin:4,"box-border-width":1,"label-size":12,"label-color":"#FFF","label-alpha":1,horizontal_count:undefined,vertical_count:undefined,color:[{color:"#339999","dark-alpha":1,"light-alpha":0.45},{color:"#99CC99","dark-alpha":1,"light-alpha":0.45},{color:"#99CC33","dark-alpha":1,"light-alpha":0.45},{color:"#CCCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FFCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FF6633","dark-alpha":1,"light-alpha":0.45},{color:"#FF3333","dark-alpha":1,"light-alpha":0.45},{color:"#CC0066","dark-alpha":1,"light-alpha":0.45}]},tagcloud:{levels:10,"text-min-size":10,"text-max-size":55,"row-count":5,horizontal_margin:5,vertical_margin:-10,color:[{color:"#339999","dark-alpha":1,"light-alpha":0.45},{color:"#99CC99","dark-alpha":1,"light-alpha":0.45},{color:"#99CC33","dark-alpha":1,"light-alpha":0.45},{color:"#CCCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FFCC33","dark-alpha":1,"light-alpha":0.45},{color:"#FF6633","dark-alpha":1,"light-alpha":0.45},{color:"#FF3333","dark-alpha":1,"light-alpha":0.45},{color:"#CC0066","dark-alpha":1,"light-alpha":0.45}]},color:[{color:"#66B3DD","dark-alpha":1,"light-alpha":0.45},{color:"#EF7D31","dark-alpha":1,"light-alpha":0.45},{color:"#ABC93C","dark-alpha":1,"light-alpha":0.45},{color:"#E05170","dark-alpha":1,"light-alpha":0.45},{color:"#297FB5","dark-alpha":1,"light-alpha":0.45},{color:"#F5BE21","dark-alpha":1,"light-alpha":0.45},{color:"#5ABABB","dark-alpha":1,"light-alpha":0.45},{color:"#9D66A4","dark-alpha":1,"light-alpha":0.45}]};d.InfoViz.chart=function(j,k,i,f){var n=d(j).attr("id")?d(j).attr("id"):"infoviz_"+b();d(j).attr("id",n);var g=Raphael(n,d(j).width(),d(j).height());var o=c(f);var e={"top-left":[o.layout["padding-left"],o.layout["padding-top"]],"top-right":[g.width-o.layout["padding-right"],o.layout["padding-top"]],"bottom-left":[o.layout["padding-left"],g.height-o.layout["padding-bottom"]],"bottom-right":[g.width-o.layout["padding-right"],g.height-o.layout["padding-bottom"]],width:g.width,height:g.height};g.rect(0,0,g.width,g.height).attr({stroke:"none",fill:o.layout["background-color"],"fill-opacity":o.layout["background-alpha"]});switch(k){case"linechart":e=d.InfoViz.draw_axis(g,i,o);d.InfoViz.draw_linechart(g,e,i,o);break;case"bubblechart":e=d.InfoViz.draw_axis(g,i,o);d.InfoViz.draw_bubblechart(g,e,i,o);break;case"barchart":e=d.InfoViz.draw_axis(g,i,o);d.InfoViz.draw_barchart(g,e,i,o);break;case"piechart":e=d.InfoViz.draw_simple_background(g,i,o);d.InfoViz.draw_piechart(g,e,i,o);break;case"radarchart":e=d.InfoViz.draw_simple_background(g,i,o);d.InfoViz.draw_radarchart(g,e,i,o);break;case"heatmap":e=d.InfoViz.draw_simple_background(g,i,o);d.InfoViz.draw_heatmap(g,e,i,o);break;case"tagcloud":e=d.InfoViz.draw_simple_background(g,i,o);d.InfoViz.draw_tagcloud(g,e,i,o);break;default:g.text(e.width/2,e.height/2,'Type "'+k+'" not supported.').attr({"font-size":12,fill:"#000"}).translate(0.5,0.5);break}if(o.layout["logo-enabled"]){var m,l;switch(o.layout["logo-position"]){default:case"top-right":m=e["top-right"][0]-o.layout["logo-width"];l=e["top-right"][1];break;case"top-left":m=e["top-left"][0];l=e["top-right"][1];break;case"bottom-left":m=e["bottom-left"][0];l=e["bottom-left"][1]-o.layout["logo-height"];break;case"bottom-right":m=e["bottom-right"][0]-o.layout["logo-width"];l=e["bottom-right"][1]-o.layout["logo-height"];break}var h=g.image("./images/infoviz_logo_tiny.png",m,l,o.layout["logo-width"],o.layout["logo-height"]).attr({cursor:"pointer"}).translate(0.5,0.5);h.click(function(){window.location.href="https://github.com/nocoo/InfoViz"})}};d.InfoViz.draw_simple_background=function(g,j,f){if(!g){return a("Paper is empty.")}var p=c(f),k={},o=g.width,i=g.height,e=[],n,m;var h=g.rect(0,0,o,i);h.attr({stroke:"none",fill:p.layout["background-color"],"fill-opacity":p.layout["background-alpha"]});var l=g.rect(p.layout["padding-left"],p.layout["padding-top"],o-p.layout["padding-left"]-p.layout["padding-right"],i-p.layout["padding-top"]-p.layout["padding-bottom"],p.grid["border-radius"]);l.attr({stroke:p.grid["border-color"],"stroke-width":p.grid["border-width"],"stroke-opacity":p.grid["border-alpha"],fill:p.grid["background-color"],"fill-opacity":p.grid["background-alpha"]});l.translate(0.5,0.5);n=p.layout["padding-left"]+p.grid["border-width"]+p.grid["padding-left"];m=i-p.layout["padding-bottom"]-p.grid["border-width"]-p.grid["padding-bottom"];k["bottom-left"]=[n,m];m=p.layout["padding-top"]+p.grid["border-width"]+p.grid["padding-top"];k["top-left"]=[n,m];n=o-p.layout["padding-right"]-p.grid["border-width"]-p.grid["padding-right"];m=k["top-left"][1];k["top-right"]=[n,m];m=k["bottom-left"][1];k["bottom-right"]=[n,m];k.width=k["top-right"][0]-k["top-left"][0];k.height=k["bottom-right"][1]-k["top-right"][1];return k};d.InfoViz.draw_axis=function(m,v,i){if(!m){return a("Paper is empty.")}var g=c(i),j={},s=m.width,h=m.height,p=[],l,k;var t=m.rect(0,0,s,h);t.attr({stroke:"none",fill:g.layout["background-color"],"fill-opacity":g.layout["background-alpha"]});var n=m.rect(g.layout["padding-left"],g.layout["padding-top"],s-g.layout["padding-left"]-g.layout["padding-right"],h-g.layout["padding-top"]-g.layout["padding-bottom"],g.grid["border-radius"]);n.attr({stroke:g.grid["border-color"],"stroke-width":g.grid["border-width"],"stroke-opacity":g.grid["border-alpha"],fill:g.grid["background-color"],"fill-opacity":g.grid["background-alpha"]});n.translate(0.5,0.5);l=g.layout["padding-left"]+g.grid["border-width"]+g.grid["padding-left"]+g.grid["vertical-label-margin"]+g.grid["vertical-label-spacing"]+g.grid["vertical-label-margin"];k=h-g.layout["padding-bottom"]-g.grid["border-width"]-g.grid["padding-bottom"]-g.grid["horizontal-label-margin"]-g.grid["horizontal-label-spacing"]-g.grid["horizontal-label-margin"];j["bottom-left"]=[l,k];k=g.layout["padding-top"]+g.grid["border-width"]+g.grid["padding-top"];j["top-left"]=[l,k];l=s-g.layout["padding-right"]-g.grid["border-width"]-g.grid["padding-right"];k=j["top-left"][1];j["top-right"]=[l,k];k=j["bottom-left"][1];j["bottom-right"]=[l,k];j.width=j["top-right"][0]-j["top-left"][0];j.height=j["bottom-right"][1]-j["top-right"][1];p=[];p.push("M"+j["bottom-left"][0]+","+j["bottom-left"][1]);p.push("L"+j["top-left"][0]+","+j["top-left"][1]);var w=m.path(p.join(""));w.attr({stroke:g.grid["axis-color"],"stroke-width":g.grid["axis-width"],"stroke-opacity":g.grid["axis-alpha"]});w.translate(0.5,0.5);p=[];p.push("M"+j["bottom-left"][0]+","+j["bottom-left"][1]);p.push("L"+j["bottom-right"][0]+","+j["bottom-right"][1]);var u=m.path(p.join(""));u.attr({stroke:g.grid["axis-color"],"stroke-width":g.grid["axis-width"],"stroke-opacity":g.grid["axis-alpha"]});u.translate(0.5,0.5);var q=m.circle(j["bottom-left"][0],j["bottom-left"][1],g.grid["axis-dot-size"]);q.attr({stroke:"none",fill:g.grid["axis-color"],"fill-opacity":g.grid["axis-alpha"]});q.translate(0.5,0.5);var e=m.circle(j["top-left"][0],j["top-left"][1],g.grid["axis-dot-size"]);e.attr({stroke:"none",fill:g.grid["axis-color"],"fill-opacity":g.grid["axis-alpha"]});e.translate(0.5,0.5);var o=m.circle(j["bottom-right"][0],j["bottom-right"][1],g.grid["axis-dot-size"]);o.attr({stroke:"none",fill:g.grid["axis-color"],"fill-opacity":g.grid["axis-alpha"]});o.translate(0.5,0.5);if(v.vertical_axis_name){l=j["top-left"][0]-g.grid["vertical-label-margin"]*2;k=j["top-left"][1]+g.grid["vertical-name-size"]/2;var f=m.text(l,k,v.vertical_axis_name);f.attr({"text-anchor":"end","font-weight":"bold","font-size":g.grid["vertical-name-size"],fill:g.grid["vertical-name-color"]})}if(v.horizontal_axis_name){l=j["bottom-right"][0];k=j["bottom-right"][1]+g.grid["horizontal-name-size"]/2+g.grid["horizontal-label-margin"]*2;var r=m.text(l,k,v.horizontal_axis_name);r.attr({"text-anchor":"end","font-weight":"bold","font-size":g.grid["horizontal-name-size"],fill:g.grid["horizontal-name-color"]})}return j};d.InfoViz.draw_bubblechart=function(f,p,P,C){if(!f||!P){return a("Paper or Data is empty.")}var z=c(C),q=[],O,L,J,o,E;var A=Infinity,S=-Infinity,F=Infinity,n=-Infinity,g=-Infinity,D=Infinity;for(O=0;O<P.data.length;++O){E=P.data[O];if(E[P.horizontal_field]>S){S=E[P.horizontal_field]}if(E[P.horizontal_field]<A){A=E[P.horizontal_field]}if(E[P.vertical_field]>n){n=E[P.vertical_field]}if(E[P.vertical_field]<F){F=E[P.vertical_field]}if(E[P.size_field]>g){g=E[P.size_field]}if(E[P.size_field]<D){D=E[P.size_field]}}A=Math.floor(A/10)*10;S=Math.ceil(S/10)*10;F=Math.floor(F/10)*10;n=Math.ceil(n/10)*10;var M=p["top-left"][0]+z.bubblechart["padding-left"];var w=(p["top-right"][0]-z.bubblechart["padding-right"]-M)/(S-A);var N=p["bottom-left"][1]-z.bubblechart["padding-bottom"];var G=(N-p["top-left"][1]-z.bubblechart["padding-top"])/(n-F);var R=z.bubblechart["circle-min-radius"];var u=(z.bubblechart["circle-max-radius"]-R)/(g-D);var k,Q,t,K,v,s,H,B=[],h=[];for(O=0;O<P.data.length;++O){E=P.data[O];k=E[P.horizontal_field];Q=E[P.vertical_field];t=E[P.size_field];K=E[P.label_field];v=z.color[(O%z.color.length)];o=R+t*u;L=M+k*w;J=N-(Q-F)*G;s=f.circle(L,J,o).attr({fill:v.color,"fill-opacity":v["light-alpha"],stroke:v.color,"stroke-opacity":v["dark-alpha"],"stroke-width":z.bubblechart["circle-border-width"]}).translate(0.5,0.5);H=f.text(L,J,K).attr({fill:v.color,"font-size":z.bubblechart["label-size"],"text-anchor":"middle"}).translate(0.5,0.5);s.data("data",E);H.data("data",E);B.push(s);h.push(H)}for(O=0;O<B.length;++O){(function(i,y,x){i.mouseover(function(){i.stop().animate({"fill-opacity":z.color[0]["dark-alpha"]},z.layout["speed"],">");y.stop().animate({fill:"#FFF"},z.layout["speed"],">")});i.mouseout(function(){i.stop().animate({"fill-opacity":z.color[0]["light-alpha"]},z.layout["speed"],"<");y.stop().animate({fill:y.data("color")},z.layout["speed"],"<")})})(B[O],h[O],O);B[O].data("color",h[O].attr("fill"))}var r=(N-p["top-left"][1]-z.bubblechart["padding-top"])/(z.bubblechart["vertical-label-count"]-1);var m=(n-F)/(z.bubblechart["vertical-label-count"]-1);q=[];L=p["top-left"][0]-z.bubblechart["vertical-bar-width"];J=N;var l=F;for(O=0;O<z.bubblechart["vertical-label-count"];++O){q.push("M"+L+","+J+"L"+p["top-left"][0]+","+J);f.path(q.join("")).attr({stroke:z.grid["axis-color"],"stroke-opacity":z.grid["axis-alpha"],"stroke-width":z.grid["axis-width"]}).translate(0.5,0.5);f.text(L-z.bubblechart["vertical-bar-width"],J,l.toFixed(2)).attr({"text-anchor":"end",fill:z.grid["vertical-label-color"],"font-size":z.grid["vertical-label-size"]}).translate(0.5,0.5);J-=r;l+=m}var I=(p["top-right"][0]-z.bubblechart["padding-right"]-M)/(z.bubblechart["vertical-label-count"]-1);var e=(S-A)/(z.bubblechart["vertical-label-count"]-1);q=[];L=M;J=p["bottom-left"][1]+z.bubblechart["horizontal-bar-width"];var j=A;for(O=0;O<z.bubblechart["horizontal-label-count"];++O){q.push("M"+L+","+J+"L"+L+","+p["bottom-left"][1]);f.path(q.join("")).attr({stroke:z.grid["axis-color"],"stroke-opacity":z.grid["axis-alpha"],"stroke-width":z.grid["axis-width"]}).translate(0.5,0.5);f.text(L,J+z.bubblechart["horizontal-bar-width"]*2,j.toFixed(2)).attr({fill:z.grid["horizontal-label-color"],"font-size":z.grid["horizontal-label-size"]}).translate(0.5,0.5);L+=I;j+=e}};d.InfoViz.draw_linechart=function(f,s,S,E){if(!f||!S){return a("Paper or Data is empty.")}var A=c(E),t=[],M,L;var I=S.data,w=[],B=[],R,Q,P,G;var D=S.horizontal_field,g=S.vertical_field;var l,T,C=Infinity,U=-Infinity,J=Infinity,p=-Infinity;for(var r in I){for(R=0;R<I[r]["data"].length;++R){G=I[r]["data"][R];if(G[D]){l=G[D]}else{l="N/A"}if(l>U){U=l}if(l<C){C=l}if(d.inArray(l,w)===-1){w.push(l)}if(G[g]){T=G[g]}else{T="N/A"}if(T>p){p=T}if(T<J){J=T}if(d.inArray(T,B)===-1){B.push(T)}}}J=Math.floor(J/10)*10;p=Math.ceil(p/10)*10;var N=s["top-left"][0]+A.linechart["padding-left"];var z=(s["top-right"][0]-A.linechart["padding-right"]-N)/(w.length-1);var O=s["bottom-left"][1]-A.linechart["padding-bottom"];var K=(O-s["top-left"][1]-A.linechart["padding-top"])/(p-J);var h={};var u=(O-s["top-left"][1]-A.linechart["padding-top"])/(A.linechart["vertical-label-count"]-1);var o=Math.floor((p-J)/(A.linechart["vertical-label-count"]-1));t=[];M=s["top-left"][0]-A.linechart["vertical-bar-width"];L=O;var m=J;for(R=0;R<A.linechart["vertical-label-count"];++R){t.push("M"+M+","+L+"L"+s["top-left"][0]+","+L);f.path(t.join("")).attr({stroke:A.grid["axis-color"],"stroke-opacity":A.grid["axis-alpha"],"stroke-width":A.grid["axis-width"]}).translate(0.5,0.5);f.text(M-A.linechart["vertical-bar-width"],L,m).attr({"text-anchor":"end",fill:A.grid["vertical-label-color"],"font-size":A.grid["vertical-label-size"]}).translate(0.5,0.5);L-=u;m+=o}var q;t=[];M=N;L=s["bottom-right"][1]+A.grid["horizontal-name-size"]/2+A.grid["horizontal-label-margin"]*2;for(R=0;R<w.length;++R){t.push("M"+M+","+s["bottom-left"][1]);t.push("L"+M+","+s["top-left"][1]);h[w[R]]=M;f.text(M,L,w[R]).attr({"text-anchor":"middle","font-size":A.grid["horizontal-label-size"],fill:A.grid["horizontal-label-color"]}).translate(0.5,0.5);M+=z}q=f.path(t.join(""));q.attr({stroke:A.grid["grid-color"],"stroke-dasharray":"--..","stroke-linecap":"butt","stroke-width":A.grid["grid-width"],"stroke-opacity":A.grid["grid-alpha"]});q.translate(0.5,0.5);var H=0,F;for(var r in I){var e,v,n;t=[];F=A.color[(H%A.color.length)];for(R=0;R<I[r]["data"].length;++R){G=I[r]["data"][R];M=h[G[D]];L=O-G[g]*K+A.linechart["circle-radius"];if(R===0){t.push("M"+M+","+L)}else{t.push("L"+M+","+L)}v=f.circle(M,L,A.linechart["circle-radius"]);v.attr({stroke:F.color,"stroke-opacity":F["dark-alpha"],"stroke-width":A.linechart["line-width"],fill:F.color}).translate(0.5,0.5)}e=f.path(t.join(""));e.attr({stroke:F.color,"stroke-opacity":F["light-alpha"],"stroke-width":A.linechart["line-width"]}).translate(0.5,0.5);n=f.text(M+A.linechart["circle-radius"]*2,L,I[r]["name"]);n.attr({fill:F.color,"text-anchor":"start","font-size":A.linechart["label-size"]}).translate(0.5,0.5);H++}};d.InfoViz.draw_barchart=function(f,r,U,D){if(!f||!U){return a("Paper or Data is empty.")}var z=c(D),s=[],M,L,Q=0;var H=U.data,v=[],A=[],T,S,R,F;var C=U.horizontal_field,g=U.vertical_field;var l,V,B=Infinity,W=-Infinity,I=Infinity,o=-Infinity;for(var q in H){for(T=0;T<H[q]["data"].length;++T){F=H[q]["data"][T];if(F[C]){l=F[C]}else{l="N/A"}if(l>W){W=l}if(l<B){B=l}if(d.inArray(l,v)===-1){v.push(l)}if(F[g]){V=F[g]}else{V="N/A"}if(V>o){o=V}if(V<I){I=V}if(d.inArray(V,A)===-1){A.push(V)}}++Q}I=Math.floor(I/10)*10;o=Math.ceil(o/10)*10;var O=r["top-left"][0]+z.barchart["padding-left"];var P=r["bottom-left"][1]-z.barchart["padding-bottom"];var K=(P-r["top-left"][1]-z.barchart["padding-top"])/(o-I);var h={};var t=(P-r["top-left"][1]-z.barchart["padding-top"])/(z.barchart["vertical-label-count"]-1);var n=Math.floor((o-I)/(z.barchart["vertical-label-count"]-1));s=[];M=r["top-left"][0]-z.barchart["vertical-bar-width"];L=P;var m=I;for(T=0;T<z.barchart["vertical-label-count"];++T){s.push("M"+M+","+L+"L"+r["top-left"][0]+","+L);f.path(s.join("")).attr({stroke:z.grid["axis-color"],"stroke-opacity":z.grid["axis-alpha"],"stroke-width":z.grid["axis-width"]}).translate(0.5,0.5);f.text(M-z.barchart["vertical-bar-width"],L,m).attr({"text-anchor":"end",fill:z.grid["vertical-label-color"],"font-size":z.grid["vertical-label-size"]}).translate(0.5,0.5);L-=t;m+=n}var w=(r.width-z.barchart["padding-left"]-z.barchart["padding-right"]-(v.length-1)*z.barchart["group-margin"])/v.length;var J=(w-(Q-1)*z.barchart["bar-margin"])/Q;var p;s=[];M=O+w/2;L=r["bottom-right"][1]+z.grid["horizontal-name-size"]/2+z.grid["horizontal-label-margin"]*2;for(T=0;T<v.length;++T){s.push("M"+M+","+r["bottom-left"][1]);s.push("L"+M+","+r["top-left"][1]);h[v[T]]=M-w/2;f.text(M,L,v[T]).attr({"text-anchor":"middle","font-size":z.grid["horizontal-label-size"],fill:z.grid["horizontal-label-color"]}).translate(0.5,0.5);M+=w+z.barchart["group-margin"]}p=f.path(s.join(""));p.attr({stroke:z.grid["grid-color"],"stroke-dasharray":"--..","stroke-linecap":"butt","stroke-width":z.grid["grid-width"],"stroke-opacity":z.grid["grid-alpha"]});p.translate(0.5,0.5);var G=0,E,e=[],N;for(var q in H){var u;E=z.color[(G%z.color.length)];for(T=0;T<H[q]["data"].length;++T){F=H[q]["data"][T];M=h[F[C]]+(G)*(J+z.barchart["bar-margin"]);L=P-F[g]*K;N=f.rect(M,L,J,r["bottom-left"][1]-L-1);N.attr({stroke:E.color,"stroke-opacity":E["dark-alpha"],"stroke-width":z.barchart["line-width"],fill:E.color,"fill-opacity":E["light-alpha"]}).translate(0.5,0.5);e.push(N)}G++}for(T=0;T<e.length;++T){(function(i){i.mouseover(function(){i.stop().animate({"fill-opacity":z.color[0]["dark-alpha"]},z.layout["speed"],">")});i.mouseout(function(){i.stop().animate({"fill-opacity":z.color[0]["light-alpha"]},z.layout["speed"],"<")})})(e[T])}};d.InfoViz.draw_piechart=function(g,l,Q,C){if(!g||!Q){return a("Paper or Data is empty.")}var A=c(C),m=[],I,G,O,D,K;var u=A.piechart["hole-radius"];var w=l["top-left"][0]+l.width/2;var v=l["top-left"][1]+l.height/2;if(l.width>l.height){K=Math.floor(l.height/2)*A.piechart["sector-size-factor"]}else{K=Math.floor(l.width/2)*A.piechart["sector-size-factor"]}var j=-Infinity,E=Infinity,h=0;for(O=0;O<Q.data.length;++O){D=Q.data[O];if(D[Q.value_field]>j){j=D[Q.value_field]}if(D[Q.value_field]<E){E=D[Q.value_field]}h+=D[Q.value_field]}var B=function(Y,W,x,i,Z,V,X){var aa=Math.PI/180,U=Y+x*Math.cos(-Z*aa),y=Y+x*Math.cos(-V*aa),ac=W+x*Math.sin(-Z*aa),ab=W+x*Math.sin(-V*aa);r=Y+i*Math.cos(-Z*aa),p=Y+i*Math.cos(-V*aa),S=W+i*Math.sin(-Z*aa),R=W+i*Math.sin(-V*aa);if(i>0){return g.path(["M",r,S,"L",U,ac,"A",x,x,0,+(V-Z>180),0,y,ab,"L",p,R,"A",i,i,0,-(V-Z>180),1,r,S]).attr(X)}else{return g.path(["M",Y,W,"L",U,ac,"A",x,x,0,+(V-Z>180),0,y,ab,"z"]).attr(X)}};var o=360/h;var q,k=0,z,L=[],t=[],n=[],f;var s,T,r,S,p,R,N;var J,M,H;for(O=0;O<Q.data.length;++O){D=Q.data[O][Q.value_field];q=o*D;z=A.color[(O%A.color.length)];J=B(w,v,K,u,k,k+q,{fill:z.color,"fill-opacity":z["light-alpha"],stroke:z.color,"stroke-opacity":z["dark-alpha"],"stroke-width":A.piechart["sector-border-width"]}).translate(0.5,0.5);J.data("color-alpha",z["light-alpha"]);J.data("index",O);L.push(J);f=-(k+q/2)*Math.PI/180;I=w+(K+A.piechart["label-distance"])*Math.cos(f);G=v+(K+A.piechart["label-distance"])*Math.sin(f);s=w+(K+A.piechart["label-distance"]+A.piechart["label-bar-length1"])*Math.cos(f);T=v+(K+A.piechart["label-distance"]+A.piechart["label-bar-length1"])*Math.sin(f);if(I>w){r=s+A.piechart["label-bar-length2"]}else{r=s-A.piechart["label-bar-length2"]}S=T;m=[];m.push("M"+I+","+G);m.push("L"+s+","+T);m.push("L"+r+","+S);M=g.path(m.join("")).attr({stroke:A.piechart["label-line-color"],"stroke-opacity":A.piechart["label-line-color"],"stroke-width":A.piechart["label-line-width"]}).translate(0.5,0.5);t.push(M);if(I>w){p=r+A.piechart["label-distance"];N="start"}else{p=r-A.piechart["label-distance"];N="end"}R=S;H=g.text(p,R,Q.data[O][Q.label_field]).attr({"text-anchor":N,fill:z.color,"font-size":A.piechart["label-size"]}).translate(0.5,0.5);n.push(H);k+=q}var P=Raphael.animation({transform:"s1.1 1.1 "+w+" "+v},A.layout["speed"],">");var F=Raphael.animation({transform:""},A.layout["speed"],"<");var e;for(O=0;O<L.length;++O){(function(i){i.mouseover(function(){M=t[i.data("index")];if(M){M.stop().animate(P)}H=n[i.data("index")];if(H){H.stop().animate(P)}e=P;e.anim["100"]["fill-opacity"]=1;i.stop().animate(e);delete e.anim["100"]["fill-opacity"]});i.mouseout(function(){M=t[i.data("index")];if(M){M.stop().animate(F)}H=n[i.data("index")];if(H){H.stop().animate(F)}e=F;e.anim["100"]["fill-opacity"]=i.data("color-alpha");i.stop().animate(e);delete e.anim["100"]["fill-opacity"]})})(L[O])}};d.InfoViz.draw_radarchart=function(u,r,I,o){if(!u||!I){return a("Paper or Data is empty.")}var l=c(o),z=[],v=[],t,s,D,C,E,m,H=Math.PI/180;var k=r["top-left"][0]+r.width/2;var h=r["top-left"][1]+r.height/2;if(r.width>r.height){m=Math.floor(r.height/2)*l.piechart["sector-size-factor"]}else{m=Math.floor(r.width/2)*l.piechart["sector-size-factor"]}var f=0;var w=360/I.value_fields.length;var F={},G={};for(D=0;D<I.value_fields.length;++D){F[I.value_fields[D]]={v_max:-Infinity,v_min:Infinity};G[I.value_fields[D]]={angle:f};f+=w}for(D=0;D<I.data.length;++D){for(C=0;C<I.value_fields.length;++C){E=I.data[D][I.value_fields[C]];if(E>F[I.value_fields[C]]["v_max"]){F[I.value_fields[C]]["v_max"]=E}if(E<F[I.value_fields[C]]["v_min"]){F[I.value_fields[C]]["v_min"]=E}}}u.circle(k,h,m).attr({stroke:l.radarchart["outer-border-color"],"stroke-width":l.radarchart["outer-border-width"],"stroke-opacity":l.radarchart["outer-border-alpha"],fill:l.radarchart["outer-background-color"],"fill-opacity":l.radarchart["outer-background-alpha"]}).translate(0.5,0.5);z=[];v=[];var g=0;for(D=0;D<I.value_fields.length;++D){if(D===0){z.push("M")}else{z.push("L")}t=k+m*Math.sin(G[I.value_fields[D]]["angle"]*H);s=h-m*Math.cos(G[I.value_fields[D]]["angle"]*H);G[I.value_fields[D]]["end-x"]=t;G[I.value_fields[D]]["end-y"]=s;z.push(t+","+s);v.push("M"+k+","+h+"L"+t+","+s);t=k+(m+l.radarchart["label-distance"])*Math.sin(G[I.value_fields[D]]["angle"]*H);s=h-(m+l.radarchart["label-distance"])*Math.cos(G[I.value_fields[D]]["angle"]*H);G[I.value_fields[D]]["label-x"]=t;G[I.value_fields[D]]["label-y"]=s;if(l.radarchart["label-rotation"]){g=G[I.value_fields[D]]["angle"];if(G[I.value_fields[D]]["angle"]>90&&G[I.value_fields[D]]["angle"]<270){g+=180}}u.text(t,s,I.value_fields[D]).attr({"font-size":l.radarchart["label-size"],fill:l.radarchart["label-color"],transform:"r"+g}).translate(0.5,0.5);F[I.value_fields[D]]["v_unit"]=(m-l.radarchart["circle-min-radius"])/(F[I.value_fields[D]]["v_max"]-F[I.value_fields[D]]["v_min"])}z.push("z");u.path(z.join("")).attr({stroke:l.radarchart["inner-border-color"],"stroke-width":l.radarchart["inner-border-width"],"stroke-opacity":l.radarchart["inner-border-alpha"],fill:l.radarchart["inner-background-color"],"fill-opacity":l.radarchart["inner-background-alpha"]}).translate(0.5,0.5);u.path(v.join("")).attr({stroke:l.radarchart["axis-color"],"stroke-width":l.radarchart["axis-width"],"stroke-opacity":l.radarchart["axis-alpha"]}).translate(0.5,0.5);var A=0,q,n,e=[],B;for(D=0;D<I.data.length;++D){q=l.color[(D%l.color.length)];z=[];for(C=0;C<I.value_fields.length;++C){n=I.data[D][I.value_fields[C]];A=l.radarchart["circle-min-radius"]+F[I.value_fields[C]]["v_unit"]*(n-F[I.value_fields[C]]["v_min"]);if(!A){continue}if(C===0){z.push("M")}else{z.push("L")}t=k+A*Math.sin(G[I.value_fields[C]]["angle"]*H);s=h-A*Math.cos(G[I.value_fields[C]]["angle"]*H);z.push(t+","+s)}z.push("z");B=u.path(z.join("")).attr({stroke:q.color,"stroke-width":l.radarchart["circle-border-width"],"stroke-opacity":q["dark-alpha"],fill:q.color,"fill-opacity":l.radarchart["circle-background-alpha"]}).translate(0.5,0.5);B.data("color-alpha",l.radarchart["circle-background-alpha"]);e.push(B)}for(D=0;D<e.length;++D){(function(i){i.mouseover(function(){i.animate({"fill-opacity":0.618},l.layout["speed"],"<")});i.mouseout(function(){i.animate({"fill-opacity":i.data("color-alpha")},l.layout["speed"],">")})})(e[D])}};d.InfoViz.draw_heatmap=function(q,n,G,l){if(!q||!G){return a("Paper or Data is empty.")}var f=c(l),r=[],p,o,A,z,D;var w=-Infinity,t=Infinity;for(A=0;A<G.data.length;++A){D=G.data[A];if(D[G.value_field]>w){w=D[G.value_field]}if(D[G.value_field]<t){t=D[G.value_field]}}var h=1,g=1;if(f.heatmap["horizontal_count"]>0){h=f.heatmap["horizontal_count"];g=Math.ceil(G.data.length/h)}else{if(f.heatmap["vertical_count"]>0){g=f.heatmap["vertical_count"];h=Math.ceil(G.data.length/g)}else{h=Math.floor(Math.sqrt(G.data.length));g=h}}var C=1,B=1;C=(n.width-((h-1)*f.heatmap["horizontal_margin"]))/h;B=(n.height-((g-1)*f.heatmap["vertical_margin"]))/g;var m,E,k,e,F;if(f.heatmap["color"]&&f.heatmap["color"].length>0){E=f.heatmap["color"]}else{E=f.color}o=n["top-left"][1];index=0;var s=false,v=[],u=[];for(z=0;z<g;++z){p=n["top-left"][0];for(A=0;A<h;++A){if(!G.data[index]){s=true;break}k=G.data[index][G.value_field];m=E[Math.floor((k-t)*((E.length-1)/(w-t)))];e=q.rect(p,o,C,B).attr({fill:m.color,"fill-opacity":m["dark-alpha"],stroke:m.color,"stroke-opacity":m["dark-alpha"],"stroke-width":f.heatmap["box-border-width"]}).translate(0.5,0.5);v.push(e);if(C>f.heatmap["label-size"]&&B>f.heatmap["label-size"]){F=q.text(p+C/2,o+B/2,G.data[index][G.label_field]).attr({fill:f.heatmap["label-color"],"fill-opacity":f.heatmap["label-alpha"],"font-size":f.heatmap["label-size"]}).translate(0.5,0.5);u.push(F)}p+=C+f.heatmap["horizontal_margin"];++index}if(s){break}o+=B+f.heatmap["vertical_margin"]}};d.InfoViz.draw_tagcloud=function(f,t,Q,F){if(!f||!Q){return a("Paper or Data is empty.")}var E=c(F),u=[],M,L,O,N,G;var v=E.tagcloud["levels"]?E.tagcloud["levels"]:8;var p=-Infinity,I=Infinity,o=0;for(O=0;O<Q.data.length;++O){G=Q.data[O];if(G[Q.value_field]>p){p=G[Q.value_field]}if(G[Q.value_field]<I){I=G[Q.value_field]}o+=G[Q.text_field].length}var h=[],k,e,s;for(O=0;O<Q.data.length;++O){G=Q.data[O];k=Math.floor((v-1)*(G[Q.value_field]-I)/(p-I));this_size=E.tagcloud["text-min-size"]+Math.floor(k*(E.tagcloud["text-max-size"]-E.tagcloud["text-min-size"])/v);e=f.text(-1000,-1000,G[Q.text_field]).attr({"font-size":this_size}).translate(0.5,0.5);s=e.getBBox();h.push({value:G[Q.value_field],text:G[Q.text_field],size:this_size,length:G[Q.text_field].length,level:k,width:s.width,height:s.height})}var z=t["top-left"][0]+t.width/2;var w=t["top-left"][1]+t.height/2;var P=E.tagcloud["row-count"],J=[];for(O=0;O<P;++O){J.push({node:[]})}if(P%2===0){w-=E.tagcloud["text-max-size"]/2}h.sort(function(j,i){return i.size-j.size});for(O=0;O<h.length;++O){J[O%J.length]["node"].push(h[O])}var l=[],K,R=[];var g=0,D,B,r,q,C,A;var n,m,H=0;for(O=0;O<J.length;++O){if(O===0){M=z;L=w;D=L;B=L}else{M=z;if(O%2===0){L=D-g;D=L}else{L=B+g;B=L}}r=0;q=0;C=0;A=0;g=-Infinity;for(N=0;N<J[O]["node"].length;++N){G=J[O]["node"][N];this_color=E.tagcloud["color"][Math.floor((E.tagcloud["color"].length-1)*(G.level/(v-1)))];if(N===0){n=M;m=L;C=G.width+E.tagcloud["horizontal_margin"];A=G.width+E.tagcloud["horizontal_margin"]}else{if(N%2===0){r-=C/2+G.width/2;n=M+r;C=G.width+E.tagcloud["horizontal_margin"]}else{q+=A/2+G.width/2;n=M+q;A=G.width+E.tagcloud["horizontal_margin"]}}if(G.height>g){g=G.height+E.tagcloud["vertical_margin"]}R.push({x:n,y:m,item:G,color:this_color});H++}}for(O=R.length-1;O>=0;--O){K=f.text(R[O]["x"],R[O]["y"],R[O]["item"]["text"]).attr({"font-size":R[O]["item"]["size"],fill:R[O]["color"]["color"],"fill-opacity":R[O]["color"]["dark-alpha"],"text-anchor":"middle"}).translate(0.5,0.5);l.push(K)}for(O=0;O<l.length;++O){(function(i){i.mouseover(function(){i.animate({transform:"s1.5"},E.layout["speed"],">")});i.mouseout(function(){i.animate({transform:""},E.layout["speed"],"<")})})(l[O])}};var c=function(f){if(!f){return d.InfoViz.options}var e={};d.extend(true,e,d.InfoViz.options);d.extend(true,e,f);return e};var b=function(f){var e=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};if(f==="long"){return(e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e())}else{return(e()+e())}};var a=function(e){if(console&&typeof(console.log)==="function"){console.log(e)}else{alert(e)}};d.InfoViz.global_option=function(e){d.InfoViz.options=c(e)};d.InfoViz.version=function(){return"0.1.0"};d.InfoViz.enable_logo=function(){d.InfoViz.options.layout["logo-enabled"]=true}})(jQuery);